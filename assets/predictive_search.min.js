class PredictiveSearch extends HTMLElement{constructor(){super(),this.input=this.querySelector('input[type="search"]'),this.predictiveSearchResults=this.querySelector("#predictive-search"),this.predictiveSearchContainer=document.getElementById("PredictiveSearchContainer"),this.searchButton=document.getElementById("SearchIcon"),this.searchButton.addEventListener("click",function(e){e.preventDefault(),this.togglePredictiveSearch(this.predictiveSearchContainer,this.input)}.bind(this)),this.input.addEventListener("focusout",function(e){this.input&&!this.input.value&&this.togglePredictiveSearch(this.predictiveSearchContainer)}.bind(this)),this.input.addEventListener("input",this.debounce((e=>{this.onChange(e)}),300).bind(this))}onChange(){const e=this.input.value.trim();e.length?this.getSearchResults(e):this.close()}getSearchResults(e){fetch(`/search/suggest?q=${e}&section_id=predictive-search`).then((e=>{if(!e.ok){var t=new Error(e.status);throw this.close(),t}return e.text()})).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.predictiveSearchResults.removeAttribute("hidden"),this.predictiveSearchResults.innerHTML=t,this.open()})).catch((e=>{throw this.close(),e}))}open(){this.predictiveSearchResults.style.display="block"}close(){this.predictiveSearchResults.style.display="none"}debounce(e,t){let i;return(...s)=>{clearTimeout(i),i=setTimeout((()=>e.apply(this,s)),t)}}togglePredictiveSearch(e,t){if(e){e.hasAttribute("hidden")?(e.removeAttribute("hidden"),t.click(),t.focus(),console.log(t)):e.setAttribute("hidden",!0)}}clearPredictiveSearchResult(e){e.innerHTML=""}}customElements.define("predictive-search",PredictiveSearch);